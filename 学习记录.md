# RealWorld Next.js 复刻学习记录

## 准备工作

### Fork 仓库
- 在 GitHub 上 Fork 原版仓库到自己的账号
- 原版：https://github.com/reck1ess/next-realworld-example-app

### 克隆到本地
```bash
git clone https://github.com/ZXZLUK/-1.git
cd -1
```
**解释**：`git clone` 把仓库下载到本地，`cd` 进入项目目录。

### 安装依赖
```bash
npm install --legacy-peer-deps
```
**解释**：安装项目依赖，`--legacy-peer-deps` 忽略依赖版本冲突。

---

## Git Branch 保存原版

### 创建 original 分支保存原版
```bash
git checkout -b original
```
**解释**：创建并切换到 `original` 分支，用于保存原版代码作为参考。

### 提交原版代码
```bash
git add .
git commit -m "保存原版代码作为参考"
```
**解释**：`git add` 添加所有更改，`git commit` 提交并添加说明。

### 推送分支到 GitHub
```bash
git push -u origin original
```
**解释**：把 `original` 分支上传到 GitHub，`-u` 建立追踪关系。

---

## 清空 master 分支准备从零构建

### 切换回 master 分支
```bash
git checkout master
```
**解释**：切换回 `master` 分支，准备在这里从零开始写代码。

### 删除原版代码目录
```bash
rm -rf components lib pages
```
**解释**：删除原版的代码目录，只保留配置文件。`-rf` 表示递归强制删除。

### 提交删除操作
```bash
git add -A
git commit -m "清空代码，准备从零构建"
```
**解释**：记录这次删除操作到 Git 历史。

### 推送到 GitHub
```bash
git push origin master
```
**解释**：把清空后的代码上传到 GitHub。

---

## 从零开始构建

### 创建 pages 目录
```bash
mkdir pages
```
**解释**：创建 `pages` 目录，Next.js 用这个目录识别页面路由。

### 创建入口文件
```bash
touch pages/_app.tsx
```
**解释**：创建 Next.js 应用入口文件。

### 创建首页文件
```bash
touch pages/index.tsx
```
**解释**：创建首页文件，对应 URL 路径 `/`。

### 编写第一个组件
在 `pages/index.tsx` 中输入：
```tsx
export default function Home() {
  return <h1>Hello World</h1>;
}
```
**解释**：这是一个最简单的 React 组件，返回一个标题元素。

### 启动开发服务器
```bash
export NODE_OPTIONS=--openssl-legacy-provider && npm run dev
```
**解释**：启动 Next.js 开发服务器，`NODE_OPTIONS` 解决 Node.js 版本兼容问题。

---

## Git 常用命令

| 命令 | 作用 |
|:---|:---|
| `git status` | 查看当前状态 |
| `git log --oneline` | 查看提交历史 |
| `git branch` | 查看所有分支 |
| `git checkout 分支名` | 切换分支 |
| `git add .` | 添加所有更改 |
| `git commit -m "说明"` | 提交更改 |
| `git push` | 上传到 GitHub |

---

## 项目结构

```
-1/
├── pages/           # 页面目录（Next.js 路由）
│   ├── _app.tsx    # 应用入口
│   └── index.tsx   # 首页
├── package.json    # 依赖配置
├── tsconfig.json   # TypeScript 配置
└── 学习记录.md     # 本文件
```

---

## 添加全局样式

### 创建 _document.tsx 引入外部样式
```bash
touch pages/_document.tsx
```

在 `pages/_document.tsx` 中输入：
```tsx
import Document, { Head, Main, NextScript } from 'next/document';

export default class MyDocument extends Document {
  render() {
    return (
      <html>
        <Head>
          <link rel="stylesheet" href="//demo.productionready.io/main.css" />
        </Head>
        <body>
          <Main />
          <NextScript />
        </body>
      </html>
    );
  }
}
```
**解释**：Next.js 的文档入口，引入 RealWorld 的官方样式库。

---

## 添加导航栏

### 创建导航栏组件
```bash
mkdir -p components/common && touch components/common/Navbar.tsx
```

在 `components/common/Navbar.tsx` 中输入：
```tsx
import Link from 'next/link';

export default function Navbar() {
  return (
    <nav className="navbar navbar-light">
      <div className="container">
        <Link href="/">
          <a className="navbar-brand">conduit</a>
        </Link>
        <ul className="nav navbar-nav pull-xs-right">
          <li className="nav-item">
            <Link href="/"><a className="nav-link">Home</a></Link>
          </li>
          <li className="nav-item">
            <Link href="/user/login"><a className="nav-link">Sign in</a></Link>
          </li>
          <li className="nav-item">
            <Link href="/user/register"><a className="nav-link">Sign up</a></Link>
          </li>
        </ul>
      </div>
    </nav>
  );
}
```
**解释**：导航栏组件，使用 Next.js 的 `<Link>` 组件实现页面跳转。

### 在 _app.tsx 中引入导航栏
```tsx
import type { AppProps } from 'next/app';
import Navbar from '../components/common/Navbar';

export default function App({ Component, pageProps }: AppProps) {
  return (
    <>
      <Navbar />
      <Component {...pageProps} />
    </>
  );
}
```
**解释**：在应用入口引入导航栏，让所有页面都显示导航栏。

---

## 添加登录页面

### 创建登录页面
```bash
mkdir pages/user && touch pages/user/login.tsx
```

在 `pages/user/login.tsx` 中输入：
```tsx
export default function LoginPage() {
  return (
    <div className="auth-page">
      <div className="container page">
        <div className="row">
          <div className="col-md-6 offset-md-3 col-xs-12">
            <h1 className="text-xs-center">Sign In</h1>
            <p className="text-xs-center">
              <a href="/user/register">Need an account?</a>
            </p>
            <form>
              <fieldset>
                <input type="text" placeholder="Email" />
                <input type="password" placeholder="Password" />
                <button type="submit">Sign in</button>
              </fieldset>
            </form>
          </div>
        </div>
      </div>
    </div>
  );
}
```
**解释**：登录表单页面，URL 路径为 `/user/login`。

---

## 添加注册页面

### 创建注册页面
```bash
touch pages/user/register.tsx
```

在 `pages/user/register.tsx` 中输入：
```tsx
export default function RegisterPage() {
  return (
    <div className="auth-page">
      <div className="container page">
        <div className="row">
          <div className="col-md-6 offset-md-3 col-xs-12">
            <h1 className="text-xs-center">Sign Up</h1>
            <p className="text-xs-center">
              <a href="/user/login">Have an account?</a>
            </p>
            <form>
              <fieldset>
                <input type="text" placeholder="Username" />
                <input type="email" placeholder="Email" />
                <input type="password" placeholder="Password" />
                <button type="submit">Sign up</button>
              </fieldset>
            </form>
          </div>
        </div>
      </div>
    </div>
  );
}
```
**解释**：注册表单页面，URL 路径为 `/user/register`。

---

## 添加文章列表首页

### 更新首页
在 `pages/index.tsx` 中输入：
```tsx
import Link from 'next/link';

export default function Home() {
  const articles = [
    {
      slug: 'article-1',
      title: 'How to build web apps with Next.js',
      author: 'John Doe',
      date: '2026-01-13',
      description: 'Learn the basics of Next.js.',
    },
    // ... 更多文章
  ];

  return (
    <div className="home-page">
      <div className="container page">
        <div className="row">
          <div className="col-md-9">
            {articles.map((article) => (
              <div key={article.slug} className="article-preview">
                <Link href={`/article/${article.slug}`}>
                  <a className="preview-link">
                    <h1>{article.title}</h1>
                    <p>{article.description}</p>
                    <span>Read more...</span>
                  </a>
                </Link>
              </div>
            ))}
          </div>
          <div className="col-md-3">
            <div className="sidebar">
              <p>Popular Tags</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
```
**解释**：首页显示文章列表，点击文章标题跳转到详情页。

---

## 添加文章详情页

### 创建动态路由文章详情页
```bash
mkdir pages/article && touch "pages/article/[pid].tsx"
```

在 `pages/article/[pid].tsx` 中输入：
```tsx
import { useRouter } from 'next/router';

export default function ArticlePage() {
  const router = useRouter();
  const { pid } = router.query;

  const article = {
    title: 'How to build web apps with Next.js',
    author: 'John Doe',
    content: '<p>文章内容...</p>',
  };

  return (
    <div className="article-page">
      <div className="banner">
        <div className="container">
          <h1>{article.title}</h1>
        </div>
      </div>
      <div className="container page">
        <div dangerouslySetInnerHTML={{ __html: article.content }} />
      </div>
    </div>
  );
}
```
**解释**：`[pid].tsx` 是动态路由，`pid` 参数从 URL 中获取。

---

## 提交记录

| 提交 | 说明 |
|:---|:---|
| `143c0bd` | 添加 Hello World 首页 |
| `1d7f9a4` | 清空代码，准备从零构建 |
| `0d39511` | 添加全局样式 |
| `2fe7e20` | 添加登录页面 |
| `7b71f2f` | 添加导航栏组件 |
| `8072e91` | 添加文章列表首页 |
| `c52eff2` | 添加文章详情页 |

---

## 今天学到的关键概念

### Git & GitHub
- ✅ Fork 的意义：保存学习记录，方便对比
- ✅ Git Branch：用分支保存原版代码
- ✅ 提交流程：add → commit → push

### Next.js
- ✅ 页面路由：`pages/` 目录自动生成路由
- ✅ 动态路由：`[pid].tsx` 匹配动态参数
- ✅ `_app.tsx`：应用入口，所有页面的包装器
- ✅ `_document.tsx`：文档入口，引入全局样式
- ✅ `<Link>` 组件：页面跳转，需要包裹 `<a>` 标签（旧版本）

### React
- ✅ 组件：函数组件 `export default function`
- ✅ Props：组件属性传递
- ✅ `dangerouslySetInnerHTML`：渲染 HTML 字符串

---

## 下一步计划

- [ ] 集成 API 调用（fetch/axios）
- [ ] 添加状态管理（useState/useEffect）
- [ ] 实现表单提交功能
- [ ] 添加用户认证逻辑
- [ ] 完善错误处理
